
<div class="row mt-4">
  <div class="col-md-12">
      <ul class="nav nav-pills  nav-light">
          <li class="nav-item">
              <span class="nav-link" style="cursor: pointer;" (click)="showCompleted = false" [ngClass]="{'active': !showCompleted, 'text-primary': showCompleted}">
                Scheduled Reports <span class="badge" [ngClass]="{'badge-warning': !showCompleted,'badge-primary': showCompleted}">{{ this.queuePage.totalCount }}</span>
              </span>
          </li>
        <li class="nav-item">
            <span class="nav-link" style="cursor: pointer;" (click)="showCompleted = true"  [ngClass]="{'active': showCompleted, 'text-primary': !showCompleted}">
                Completed Reports <span class="badge" [ngClass]="{'badge-warning': showCompleted,'badge-primary': !showCompleted}">{{ this.finishedReportsPage.totalCount }}</span>
            </span>
          </li>
      </ul>
      <hr>
  </div>

</div>

<div class="row mt-4" *ngIf="showCompleted">
    <div class="col-md-12">
    <!-- <h4>Completed Reports</h4> -->

    <table class="table table-striped">
        <thead class="table-light">
          <tr>
            <th>Batch</th>
            <th>Configuration</th>
            <th>Processing Status</th>
            <th>Finish Date</th>
            <th>Validation Result</th>
            <th>Problematic Files</th>
            <!-- <th>Files total</th> -->

            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let report of this.finishedReportsPage._embedded['batch-reports']">
            <td><a [routerLink]="['/batches', report._embedded.batch.id ]">{{ report._embedded.batch.description }}</a></td>
            <td><a  [routerLink]="['/configurations', report._embedded.configuration.id]">{{ report._embedded.configuration.description }}</a></td>
            <td> {{ this.resolveCamelCase(report.status) }} </td>
            <td> {{ report.finishedDate | date:'dd.MM.y, HH:mm' }} </td>
            <td>  <span style="font-size: 16px;"  class="badge  badge-outcome"  [ngClass]="{'badge-danger' : report.summary.validationOutcome !== 'valid', 'badge-success' : report.summary.validationOutcome === 'valid'}" >{{ this.resolveCamelCase(report.summary.validationOutcome) }}</span> </td>
            <td> {{ report.summary.problematicFiles }} </td>
            <!-- <td> {{ report.summary.totalFiles }} </td> -->

            <td><a class="btn btn-info" [routerLink]="[report.id]" >Details</a> </td>
            <!-- <td>
              <span class="capitalize">{{
                config._embedded["verapdf-setup"].executionMode
                }}</span>
            </td>
            <td>{{ config.creationDate | date: "dd.MM.y, HH:mm" }}</td>
            <td>
              <a style="color: white" class="btn link btn-primary mr-2 mt-1 mb-1" [routerLink]="config.id +'/general'" role="button">Modify</a>
              <a style="color: white" class="btn btn-danger mt-1 mb-1" role="button" (click)="onDeleteFile(config)">Delete</a>
            </td> -->
            <td >
              </td>
          </tr>
        </tbody>
        <tfoot class="text-monospace font-weight-bold text-dark bg-light table-bordered">
          <tr>
            <!-- <td colspan="5" class="text-center" *ngIf="this.descriptionFilter.length > 0">
              {{
              this.configurationsPage._embedded.configurations.length === 0
              ? "No matching records"
              : "Matching records: " + this.configurationsPage.totalCount
              }}
            </td>
          *ngIf="this.descriptionFilter.length == 0"
          -->
            <td colspan="8" class="text-center" >
              {{
              this.finishedReportsPage._embedded['batch-reports'].length === 0
              ? "No Reports"
              : this.finishedReportsPage.totalCount + " Reports"
              }}
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
</div>

<div *ngIf="showCompleted">
  <app-paginator [page]="this.finishedReportsPage" (navigationRequested)="onLoadReportsPage($event)"></app-paginator>
</div>


<div class="row mt-4" *ngIf="!showCompleted">

  <div class="col-md-12">
      <!-- <h4>Scheduled Reports</h4> -->
      <table class="table table-striped">
          <thead class="table-light">
            <tr>
              <th>Batch</th>
              <th>Configuration</th>
              <th>Submitted</th>
              <th>Progress</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let order of this.queuePage._embedded.orders">
              <td><a [routerLink]="['/batches', order._embedded.batch.id]">{{ order._embedded.batch.description }}</a></td>
              <td><a  [routerLink]="['/configurations', order._embedded.configuration.id]">{{ order._embedded.configuration.description }}</a></td>
              <!-- <td>
                <span class="capitalize">{{
                  config._embedded["verapdf-setup"].executionMode
                  }}</span>
              </td>
              <td>{{ config.creationDate | date: "dd.MM.y, HH:mm" }}</td>
              <td>
                <a style="color: white" class="btn link btn-primary mr-2 mt-1 mb-1" [routerLink]="config.id +'/general'" role="button">Modify</a>
                <a style="color: white" class="btn btn-danger mt-1 mb-1" role="button" (click)="onDeleteFile(config)">Delete</a>
              </td> -->
              <td> {{ order.createdDate | date:'dd.MM.y, HH:mm'}} </td>
              <td > <div class="progress position-relative bg-warning">
                <div class="progress-bar progress-bar-animated" role="progressbar" [style.width.%]="order.progress">
                    <small class="justify-content-center d-flex position-absolute w-100">{{ order.progress/100 | percent:'1.2-5' }}</small>

                </div>
              </div>
                </td>
            </tr>
          </tbody>
          <tfoot class="text-monospace font-weight-bold text-dark bg-light table-bordered">
            <tr>
              <td colspan="5" class="text-center" >
                {{
                this.queuePage._embedded.orders.length === 0
                ? "No Reports"
                : this.queuePage.totalCount + " Reports"
                }}
              </td>
            </tr>
          </tfoot>
        </table>
  </div>


</div>
<div *ngIf="!showCompleted">
    <app-paginator [page]="this.queuePage" (navigationRequested)="onLoadQueuePage($event)"></app-paginator>
</div>
